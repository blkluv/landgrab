<h1><%= admin_title @post, suffix: '- Bulk Association' %></h1>

<% if @plot.nil? %>
  <p>First, pick a plot whose tiles we'll be bulk associating to this post...
  <%= form_with(url: bulk_association_edit_admin_post_path(@post), method: :get) do |form| %>
    <div class="col-sm-4 mb-3">
      <%= label_tag :plot, 'Plot', class: 'visually-hidden' %>
      <%= select_tag :plot, option_groups_from_collection_for_select(Project.order(:title), :plots, :title, :hashid, :title, params[:plot]),
                            { include_blank: '[ Select Plot ]', class: 'form-select' } %>
    </div>

    <%= form.submit 'Choose Plot', class: 'btn btn-primary' %>
  <% end %>
<% else %>
  <p>
    Bulk associating to tiles in plot:
    <%= link_to @plot.title, admin_plot_path(@plot) %>
  </p>
  <p>
    Use the polygon icon on the map below to draw around a section of the plot
    and we'll assign all contained tiles to the post.
  </p>

  <%= render 'static_pages/w3w_map', tiles: @plot.tiles %>
<% end %>
